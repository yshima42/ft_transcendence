generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                                       String         @id
  createdAt                                DateTime       @default(now())
  updatedAt                                DateTime
  name                                     String         @unique
  avatarUrl                                String
  nickname                                 String         @unique @default("")
  onlineStatus                             OnlineStatus   @default(ONLINE)
  MatchResult_MatchResult_opponentIdToUser MatchResult[]  @relation("MatchResult_opponentIdToUser")
  MatchResult_MatchResult_userIdToUser     MatchResult[]  @relation("MatchResult_userIdToUser")
  Relationship_Relationship_peerIdToUser   Relationship[] @relation("Relationship_peerIdToUser")
  Relationship_Relationship_userIdToUser   Relationship[] @relation("Relationship_userIdToUser")
}

model MatchResult {
  id                                String   @id
  createdAt                         DateTime @default(now())
  updatedAt                         DateTime
  userId                            String
  opponentId                        String
  userScore                         Int
  opponentScore                     Int
  win                               Boolean
  User_MatchResult_opponentIdToUser User     @relation("MatchResult_opponentIdToUser", fields: [opponentId], references: [id])
  User_MatchResult_userIdToUser     User     @relation("MatchResult_userIdToUser", fields: [userId], references: [id])
}

model Relationship {
  createdAt                      DateTime         @default(now())
  updatedAt                      DateTime
  userId                         String
  peerId                         String
  type                           RelationshipType
  User_Relationship_peerIdToUser User             @relation("Relationship_peerIdToUser", fields: [peerId], references: [id])
  User_Relationship_userIdToUser User             @relation("Relationship_userIdToUser", fields: [userId], references: [id])

  @@id([userId, peerId])
}

enum OnlineStatus {
  ONLINE
  OFFLINE
  INGAME
}

enum RelationshipType {
  FRIEND
  INCOMING
  OUTGOING
}
